init python:
    import base64

    # Create our own manager that isn't affected by rollback
    gm = GameManager()

    # Sets a function to be called every time the game enters a label
    config.label_callback = gm.game_state.label_callback

    # Setup all features
    features = { }
    features.gallery = Gallery()
    features.punish = Punish()

    # Add all features to window manager
    for i in vars(features).values():
        gm.windows.add(i)

    # Define keys for the keymaps specified below
    for k, v in KEY_BINDS.items():
        config.keymap[k] = v

    # Create keymaps. These define the actions to be performed when a keybind is pressed.
    # Any names that aren't in KEY_BINDS will automatically be ignored
    Util.add_underlay_keymap(toggle_gallery_window=Function(gm.windows.toggle, "gallery"))
    Util.add_underlay_keymap(toggle_punish_window=Function(gm.windows.toggle, "punish"))
    Util.add_underlay_keymap(gallery_prev_image=Function(features.gallery.cycle_image, -1))
    Util.add_underlay_keymap(gallery_next_image=Function(features.gallery.cycle_image, 1))
    Util.add_underlay_keymap(gallery_zoom_out=Function(features.gallery.modify_image_zoom, -0.05))
    Util.add_underlay_keymap(gallery_zoom_in=Function(features.gallery.modify_image_zoom, 0.05))
    Util.add_underlay_keymap(gallery_zoom_reset=Function(features.gallery.set_image_zoom, GALLERY_DEFAULT_ZOOM))
    Util.add_underlay_keymap(gallery_move_left=Function(features.gallery.modify_image_pos, -0.02, "x"))
    Util.add_underlay_keymap(gallery_move_right=Function(features.gallery.modify_image_pos, 0.02, "x"))
    Util.add_underlay_keymap(gallery_move_up=Function(features.gallery.modify_image_pos, -0.02, "y"))
    Util.add_underlay_keymap(gallery_move_down=Function(features.gallery.modify_image_pos, 0.02, "y"))
    Util.add_underlay_keymap(gallery_move_reset=Function(features.gallery.set_image_pos))


# Initialize common images
init:
    image plus_mini_idle = im.Scale("screens/plus.png", 22, 22, bilinear=True)
    image plus_mini_hover = im.Scale("screens/plus_hover.png", 22, 22, bilinear=True)

    image minus_mini_idle = im.Scale("screens/minus.png", 22, 22, bilinear=True)
    image minus_mini_hover = im.Scale("screens/minus_hover.png", 22, 22, bilinear=True)

    image gui_one_idle = im.Data(base64.b64decode("""
    iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAQAAACQTsNJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGb2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTExLTE5VDIyOjQ4OjM3KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0xMi0wMVQwODozMDowNSswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0xMi0wMVQwODozMDowNSswMTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3Y2JjNzAxZC05ZjA2LTIwNDItOTc3Mi0wODM2MjU5YWExMDMiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozOTc0ZmQyZi1jNWRhLWRiNDEtOTI5OC00YWNhYjBkOTk1NGQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozNzJjNzM0ZS0yZWI3LTIxNDYtYjhiMy1kNDIzYjExODZiMGIiPiA8cGhvdG9zaG9wOlRleHRMYXllcnM+IDxyZGY6QmFnPiA8cmRmOmxpIHBob3Rvc2hvcDpMYXllck5hbWU9IjEiIHBob3Rvc2hvcDpMYXllclRleHQ9IjEiLz4gPC9yZGY6QmFnPiA8L3Bob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjM3MmM3MzRlLTJlYjctMjE0Ni1iOGIzLWQ0MjNiMTE4NmIwYiIgc3RFdnQ6d2hlbj0iMjAyMC0xMS0xOVQyMjo0ODozNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3Y2JjNzAxZC05ZjA2LTIwNDItOTc3Mi0wODM2MjU5YWExMDMiIHN0RXZ0OndoZW49IjIwMjAtMTItMDFUMDg6MzA6MDUrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4wIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5S3P2MAAACH0lEQVRIx6WWP2gUQRSHH+kEQQOiNpJUFhaCiFbpFLXw1EYrC61sTyIKGoxpYhGNpyAoIgRzEsFSsNSAf2pNjBqDmhRJ8E7BQi/eZbOfxc28zN7OzuZ0tpmd32++3X3z5s0K4r12MshbKtSJiWlQZYoSu/xu3+Bp3rOCr8V84Uw+ZA/T5LWv9IQgF1hmLW2FoSzI/YRxmRnG6KeXXi5R5jNRQn/sg7iIBg/Zlvr2Lu7xx4exhnOOOMH2jDUTNvPScd5wIbudVx3NBNhryFmtA6uQTzr8IBchCNfUP28hJ3XonXfKKUiNvdY5xSbko4azy4MogQeygZqZtYAIO4gD0RgxWuiTeoSrphuxNRPhg3TSMNqIMGm6Mx7EzwBEmDLanPAt82O6EWYDkGGj1YS66V72GscDkCN2g4iG9WzbkMM25f4HUliF2Bhf/Oc3iYSqXai2If1GWxI+mO5025A3RlsUbmuybWkLslHX9ZGwVxPqbuBpaWVA5+0XhHlzU6cz9TTbuluU9boBvzd38Xm1vkgYi5qvMEsxoT1Xpa8J6dDUh1sZZWhd4u66+n/QYSvbQU05KOXWtWGnyh51C7UrvErFxi1GzxznaOuR8dQRf3OTTZ4KMsgvxzXuO7yeJA6nOpOUOEGBAscYYELzogXReozecWITajHl0IG+j8VcRJXj+b8WfVQyARWurO3/pLnNy8xRIyImJmKJBcY45Hf/BQvYXXNcYtqyAAAAAElFTkSuQmCC
    """), "one_idle.png")

    image gui_one_hover = im.Data(base64.b64decode("""
    iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGb2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTExLTE5VDIyOjQ4OjM3KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0xMi0wMVQwODozMDoxOCswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0xMi0wMVQwODozMDoxOCswMTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkYjJiMTA5ZC1mYzBjLWU4NGItOGE3ZS00ODYxZDhmYjNmZjAiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1ZGNkYjhjMS02ZmU0LThmNDctYmY2Yy0yY2QyMjA1NWJlODIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4NGNlY2Y4Ni01NjU4LTgwNGEtODEwMi0wYjQ5YmE3NWNhYjciPiA8cGhvdG9zaG9wOlRleHRMYXllcnM+IDxyZGY6QmFnPiA8cmRmOmxpIHBob3Rvc2hvcDpMYXllck5hbWU9IjEiIHBob3Rvc2hvcDpMYXllclRleHQ9IjEiLz4gPC9yZGY6QmFnPiA8L3Bob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjg0Y2VjZjg2LTU2NTgtODA0YS04MTAyLTBiNDliYTc1Y2FiNyIgc3RFdnQ6d2hlbj0iMjAyMC0xMS0xOVQyMjo0ODozNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkYjJiMTA5ZC1mYzBjLWU4NGItOGE3ZS00ODYxZDhmYjNmZjAiIHN0RXZ0OndoZW49IjIwMjAtMTItMDFUMDg6MzA6MTgrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4wIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4spX4FAAACv0lEQVRYw8WYS0gVURjHb0FkUnCjCNGg26IoSwoEF66siC5Z3R6gEUmJPdQI3EaB7cRd0YvpKVTUqlr0hCLXIXUpqAiNW2JEkESGPbSm/7l8A6eP78ycOQ62+Cmcc75vfo7n9U0q5fWlYlAGcuAEuANegc9EP7gPzoBGUG6T0/f9IrYCNcADn4BviZK7DGqTEJkPLoDfMQQkroKMq8haUJiggM5HsC2uSDMYNyQcAj2gDdSD1UQW7AdXwGCI0EFbkWZDggHQDuZYzKnZlOdllIxJZA34IwSeBnNjrjDFTNAFfgo5G0wiFcIrVZO01UGAsxWMCqtqsSRyUbBOQiKgQch/g4tUgzE2yIvxkN0UEzWumz1DTYM6XeQcG/AWpC0ljmlxUWNLwFP2rJuByDww7Pgv6WFxNjGNLOZbcbPDj83CxpN2kLAVKaU3rse1qI5TrPGStOEUX9+/El+4iD7WEBfgsdhrqvE2a9wnSbDEGfpdsBERZPi/J68a37DG9VEiWvJeWxEmU8WOkHcp4RXXTYLIUrZdDEsiqyZBpFISGWAi6/6DyJBqvMdE9phWzURE2GTNsmc+V41nWeN50+XFVURYvsfZM2+pxibW+B7Mstyceh02tBJhpbarjoXgB+vYZZk07yCyicWo68GioPMu63xNW3FYwrSwxWciYqaBZyzmgX765oSk3SEJOwwX6wL1meKOCDFZXWQqeCwMakrwYrRRuJA/BFP4DU1tu1/ZwO9gZwISOSG3Ov6XmS7PO8Av4c10WcwZiengsKFA2xtVTnQaSoA8ic6wEFBjtoAnhlxHbQusQyEF0gu6w2ynu24lsZxO7pO06vwoCduSs8Wy6B4jxiPGjVAl6FSELxD2GBfUebYiic8SG8AjoeQIY5T+iPokv48ErKT69zpN3kHtQ82H4imqDjCv7wBYEudDzV89BfwjzyjRjwAAAABJRU5ErkJggg==
    """), "one_hover.png")
